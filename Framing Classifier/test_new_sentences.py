import Clean_Process_Frames
import SentenceData
import math
from nltk.tokenize import sent_tokenize, word_tokenize


Clean_Process_Frames.main(False)
stop = SentenceData.stop

text = """ US President Donald Trump and Russian counterpart Vladimir Putin had another, previously undisclosed conversation at this month's G20, the White House has confirmed.
They spoke towards the end of a formal dinner but the White House has not revealed what was discussed.
President Trump has condemned media revelations of the talks as "sick".
The two leaders' relationship is under scrutiny amid allegations of Russian interference in the US election.
US intelligence agencies believe Moscow tried to tip the election in Mr Trump's favour, something denied by Russia. Mr Trump has rejected allegations of any collusion.

The extra conversation happened during a private meal of heads of state at the G20 summit in Hamburg earlier in the month.
Mr Trump left his seat and headed to Mr Putin, who had been sitting next to Mr Trump's wife, Melania, US media said. The US president was alone with Mr Putin, apart from the attendance of the Russian president's official interpreter.
Mr Trump had been seated next to Japanese PM Shinzo Abe's wife, so the US interpreter at the dinner spoke Japanese, not Russian. No media were in attendance.

Given the poor state of relations between Washington and Moscow and the controversy surrounding Russia's efforts to interfere with the US presidential campaign, each and every encounter between Mr Putin and Mr Trump is bound to be carefully scrutinised.
Thus the apparently impromptu discussion between the two men at the G20 dinner inevitably raises many questions. What was President Trump seeking to do in approaching the Russian president? Were matters of substance discussed? If so, why was no formal note taken? And why did the US president have to rely upon a Russian official for translation?
This is all highly unusual, especially at a time when relations between the two countries are laden with so many problems.
Mr Trump also appeared unaware of another dimension - the message that his tete-a-tete would send to other leaders in the room, who must have watched the US president's gambit with some unease.

The length of the talks has been disputed.
Ian Bremmer, president of the US-based Eurasia Group, who first reported them in a newsletter to clients, said: "Donald Trump got up from the table and sat down with Putin for about an hour. It was very animated and very friendly."

At the dinner, Mr Trump's wife, Melania, sat next to Mr Putin
No-one else was nearby, so the topics of discussion were not known, he said.
Mr Bremmer had not been at the dinner but said details were given to him by unnamed attendees who, he said, were "flummoxed, confused and startled" by the turn of events.
Mr Bremmer told Bloomberg he had never before seen "two major countries with a constellation of national interests that are as dissident while the two leaders seem to be doing everything possible to make nice-nice and be close to each other".
In a statement, a senior White House official said there was no "second meeting", just a brief conversation after dinner.

The official said: "The insinuation that the White House has tried to 'hide' a second meeting is false, malicious and absurd. It is not merely perfectly normal, it is part of a president's duties, to interact with world leaders."
National Security Council spokesman Michael Anton said it was not a meeting but a "pull aside", adding: "A conversation over dessert should not be characterised as a meeting."
Mr Trump later said on Twitter: Fake News story of secret dinner with Putin is 'sick.' All G20 leaders, and spouses, were invited by the Chancellor of Germany. Press knew!"
The dinner and its attendees have always been known. Only the Trump-Putin discussion had not been reported before.

What does body language tell us about the Trump-Putin G20 meeting?
At the earlier, formal meeting, their first face-to-face encounter, Mr. Trump said he had repeatedly pressed Mr Putin about the allegations of interference in the US vote.
"I said, 'Did you do it?' He said, 'No, I did not, absolutely not.' I then asked him a second time, in a totally different way. He said, 'Absolutely not.'"
There are congressional investigations, and one by a special counsel, into the allegations of Russian interference in the US election and possible collusion with the Trump team.
On Tuesday, the Senate intelligence committee said it wanted to interview Mr Trump's son, Donald Jr, and other members of the Trump team, over a meeting they had with a Russian lawyer in June last year.
Mr Trump Jr said he had attended the meeting with Natalia Veselnitskaya as he was promised damaging material on Hillary Clinton, but it did not materialise.
On Wednesday, Ms Veselnitskaya told Russia's RT television channel she would be willing to testify before the Senate on the matter.

Meanwhile, the White House said Mr Trump would nominate former Utah governor Jon Huntsman as ambassador to Russia, a key post for a president who promised to improve relations with Moscow.
Mr Huntsman, who served as ambassador to China and Singapore, needs to have his name confirmed by the Senate.
The suspicions over Russian interference are likely to play a significant factor in his confirmation process, correspondents say."" Same-sex marriage, once central to America's culture wars and a defining topic in the 2004 presidential campaign, has largely become a non-issue in the courts of both law and public opinion, leaving social conservatives with few options to fight the historic trend.
As LGBT activists and their supporters celebrated the second anniversary Monday of the U.S. Supreme Court's Obergefell decision making same-sex marriage the law of the land, the Pew Research Center reported that public support for gay marriage is at an all-time high.
The center's survey found that 62 percent of Americans favor allowing gays and lesbians to marry legally, while 32 percent are opposed to the unions – a near reversal of public sentiment in early 2004, when Pew found that 30 percent of the public backed same-sex marriage and 63 percent opposed it.
Moreover, the survey showed that for the first time, a majority of baby boomers favor gay marriage and a majority of Republican and Republican-leaning independents do not oppose it – indicating the public is changing its collective mind on the issue and not just that gay marriage foes are dying out.
The findings dovetailed with another Supreme Court victory for lesbian, gay, bisexual and transgender people, as justices Monday reaffirmed equal treatment for same-sex married couples. The court ordered Arkansas to list the names of both same-sex spouses on a child's birth certificate, even though one person might not be the child's biological parent. The ruling reversed a decision by the Arkansas Supreme Court.
"Legally and politically, I think for the vast majority of American citizens, [marriage] equality is resolved," says Jason Pierceson, a University of Illinois–Springfield political science professor who has authored several books on same-sex marriage and sexuality and politics.

But despite being stymied by the courts, opponents of gay marriage have pressed on, seeking religious exemptions to enforcing or endorsing it, he notes.
"What's happened is that the country's moved on, but I think religious conservatives haven't," Pierceson adds.
Social conservatives also won a victory – or the possibility of one, anyway – when the Supreme Court on Monday agreed to hear a case – Masterpiece Cakeshop, Ltd. v. Colorado Civil Rights Commission – about whether a baker in Colorado should have been allowed to refuse to bake a wedding cake for a gay couple. The Colorado Court of Appeals earlier ruled that the baker, Jack Phillips, broke state law prohibiting discrimination on the basis of race, sex, marital status or sexual orientation.

Phillips has argued it would violate his free exercise of religion and freedom of speech to prepare a cake celebrating a union he opposes on religious grounds.
Phillips did not object to a cake design or message in particular, said Charlie Craig, who sought to buy the cake with his husband, Dave Mullins. Instead, Phillips asked the men outright if the cake was for them, Craig told reporters in a conference call.
When they replied that it was, "He stopped and said, 'I do not make cakes for same-sex couples.' We were really just mortified that this was happening. We had never experienced this type of discrimination before," Craig recounted. "We just stood up and we walked out."
Bob Vander Plaats, president of the Iowa-based The Family Leader, says it's not about denying service to a person, but rather about endorsing the ceremony. "You're not denying people life-or-death services. You're saying, 'Pick a different vendor," says Vander Plaats, who was also national co-chairman of Texas Sen. Ted Cruz's presidential campaign.

A restaurant owner who opposes same-sex marriage would have no problem serving such a couple at dinner, but would see it as a sanctioning of the union to rent out the restaurant for their wedding reception, Vander Plaats says.
Louise Melling, a deputy legal director at the American Civil Liberties Union, said people have tried in the past to cite religious beliefs as a reason to avoid paying men and women equal wages (on the grounds that a particular religion sees men as head of the household) and to justify segregation (on the purported grounds that God did not want the races intermarrying).
The courts, she said, have said no.  """

sentences = sent_tokenize(text, language='english')
sentence_count = 0
dict_array = []

for index in range(len(sentences)):
    one = []
    two = []
    three = []
    temp = Clean_Process_Frames.Sentence(sentences[index], index)
    temp.pos_process()
    temp.ne_process()
    vs = temp.sentiment_process()
    temp.create_n_grams(one, two, three)
    sentence_count += 1
    temp_feature_dict = {}

    words = [i for i in word_tokenize(temp.text) if i.lower() not in stop]
    temp_feature_dict["sentiment_score"] = math.fabs(vs.get('compound'))
    if temp.position < 2:
        temp_feature_dict["is_first"] = 1
    else:
        temp_feature_dict["is_first"] = 0

    vivid_score = 0
    average_concrete = 0
    highest_concrete = 0
    highest_abstract = 0

    for x in words:
        if x.lower() in SentenceData.vivid_dict:
            vivid_score += float(SentenceData.vivid_dict.get(x.lower()))
        if x.lower() in SentenceData.concrete_dict:
            average_concrete += float(SentenceData.concrete_dict.get(x.lower()))
            if float(SentenceData.concrete_dict.get(x.lower())) > highest_concrete:
                highest_concrete = float(SentenceData.concrete_dict.get(x.lower()))
            if float(SentenceData.concrete_dict.get(x.lower())) < highest_abstract:
                highest_abstract = float(SentenceData.concrete_dict.get(x.lower()))
        temp_string = "1gram_"
        temp_string += SentenceData.convert_words_to_features(x, SentenceData.word_dictionary,
                                                              SentenceData.word_index)
    temp_feature_dict["highest_concrete"] = highest_concrete
    temp_feature_dict["highest_abstract"] = highest_abstract
    if len(words) > 0:
        vivid_score = vivid_score / len(words)
        average_concrete = average_concrete / len(words)
    else:
        vivid_score = 0

    temp_feature_dict["vivid_score"] = vivid_score
    temp_feature_dict["average_concrete_score"] = average_concrete
    for x in two:
        temp_string = "2gram_"
        temp_string += SentenceData.convert_grams_to_features(x, SentenceData.bi_gram_dictionary,
                                                              SentenceData.bi_gram_index)
        temp_feature_dict[temp_string] = 1

    for x in three:
        temp_string = "3gram_"
        temp_string += SentenceData.convert_grams_to_features(x, SentenceData.tri_gram_dictionary,
                                                              SentenceData.tri_gram_index)
        temp_feature_dict[temp_string] = 1

    if temp.is_ne_present:
        temp_feature_dict["is_ne_present"] = 1
    else:
        temp_feature_dict["is_ne_present"] = 0

    dict_array.append(temp_feature_dict)

X_dict_array = SentenceData.vectorizer.transform(dict_array)

vote_array = [[0 for x in range(45)] for x in range(len(sentences))]
SentenceData.vote_on_frames(X_dict_array, vote_array, SentenceData.one_vs_rest_classifier, 25)
SentenceData.vote_on_frames(X_dict_array, vote_array, SentenceData.mlp_sgd_classifier, 25)
SentenceData.vote_on_frames(X_dict_array, vote_array, SentenceData.mlp_adam_classifier, 25)
SentenceData.vote_on_frames(X_dict_array, vote_array, SentenceData.mlp_lbfgs_classifier, 25)
SentenceData.vote_on_frames(X_dict_array, vote_array, SentenceData.mlp_lbfgs_classifier2, 25)
SentenceData.vote_on_frames(X_dict_array, vote_array, SentenceData.mlp_lbfgs_classifier3, 25)


SentenceData.vote_on_frames(X_dict_array, vote_array, SentenceData.mlp_adam_classifier2, 25)
SentenceData.vote_on_frames(X_dict_array, vote_array, SentenceData.mlp_adam_classifier3, 25)
SentenceData.vote_on_frames(X_dict_array, vote_array, SentenceData.mlp_adam_classifier5, 25)
SentenceData.voting_classifier_new(vote_array, sentences, 25, False)






